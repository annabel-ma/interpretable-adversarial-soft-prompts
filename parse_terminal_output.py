#!/usr/bin/env python3
"""
Parse terminal output from evaluate_hard_prompts.py and create a table
showing best/worst hard prompt accuracy for each (lambda, prompt_length) pair.
"""

import re
from collections import defaultdict

# Terminal output data
non_adv_output = """
Evaluating 82 non-adversarial models...

  [1/82] Evaluating λ=0.0, lr=1e-03, pl=1...
    Hard=0.7817, Soft=0.7920
  [2/82] Evaluating λ=0.0, lr=1e-03, pl=5...
    Hard=0.7893, Soft=0.7034
  [3/82] Evaluating λ=0.0, lr=1e-03, pl=10...
    Hard=0.7945, Soft=0.7988
  [4/82] Evaluating λ=0.0, lr=1e-03, pl=20...
    Hard=0.8012, Soft=0.8067
  [5/82] Evaluating λ=0.0, lr=1e-03, pl=50...
    Hard=0.8024, Soft=0.7933
  [6/82] Evaluating λ=0.0, lr=1e-03, pl=100...
    Hard=0.8015, Soft=0.8089
  [7/82] Evaluating λ=0.0, lr=1e-02, pl=1...
    Hard=0.7813, Soft=0.7679
  [8/82] Evaluating λ=0.0, lr=1e-02, pl=5...
    Hard=0.7869, Soft=0.7930
  [9/82] Evaluating λ=0.0, lr=1e-02, pl=10...
    Hard=0.7966, Soft=0.8116
  [10/82] Evaluating λ=0.0, lr=1e-02, pl=20...
    Hard=0.8034, Soft=0.8000
  [11/82] Evaluating λ=0.0, lr=1e-02, pl=50...
    Hard=0.7988, Soft=0.8070
  [12/82] Evaluating λ=0.01, lr=1e-03, pl=1...
    Hard=0.7985, Soft=0.7807
  [13/82] Evaluating λ=0.01, lr=1e-03, pl=5...
    Hard=0.7771, Soft=0.7982
  [14/82] Evaluating λ=0.01, lr=1e-03, pl=10...
    Hard=0.8037, Soft=0.8043
  [15/82] Evaluating λ=0.01, lr=1e-03, pl=20...
    Hard=0.7982, Soft=0.7994
  [16/82] Evaluating λ=0.01, lr=1e-03, pl=50...
    Hard=0.7997, Soft=0.7985
  [17/82] Evaluating λ=0.01, lr=1e-03, pl=100...
    Hard=0.8028, Soft=0.8043
  [18/82] Evaluating λ=0.01, lr=1e-02, pl=1...
    Hard=0.7869, Soft=0.7679
  [19/82] Evaluating λ=0.01, lr=1e-02, pl=5...
    Hard=0.7948, Soft=0.8055
  [20/82] Evaluating λ=0.01, lr=1e-02, pl=10...
    Hard=0.7985, Soft=0.8073
  [21/82] Evaluating λ=0.01, lr=1e-02, pl=20...
    Hard=0.7951, Soft=0.8089
  [22/82] Evaluating λ=0.01, lr=1e-02, pl=100...
    Hard=0.7966, Soft=0.8168
  [23/82] Evaluating λ=0.1, lr=1e-03, pl=1...
    Hard=0.7801, Soft=0.7688
  [24/82] Evaluating λ=0.1, lr=1e-03, pl=5...
    Hard=0.7859, Soft=0.7997
  [25/82] Evaluating λ=0.1, lr=1e-03, pl=10...
    Hard=0.7963, Soft=0.8055
  [26/82] Evaluating λ=0.1, lr=1e-03, pl=20...
    Hard=0.8000, Soft=0.7966
  [27/82] Evaluating λ=0.1, lr=1e-03, pl=50...
    Hard=0.8034, Soft=0.8015
  [28/82] Evaluating λ=0.1, lr=1e-03, pl=100...
    Hard=0.8028, Soft=0.8043
  [29/82] Evaluating λ=0.1, lr=1e-02, pl=1...
    Hard=0.7700, Soft=0.6260
  [30/82] Evaluating λ=0.1, lr=1e-02, pl=5...
    Hard=0.7954, Soft=0.8058
  [31/82] Evaluating λ=0.1, lr=1e-02, pl=10...
    Hard=0.7976, Soft=0.7972
  [32/82] Evaluating λ=0.1, lr=1e-02, pl=50...
    Hard=0.8058, Soft=0.8028
  [33/82] Evaluating λ=0.1, lr=1e-02, pl=100...
    Hard=0.8012, Soft=0.6459
  [34/82] Evaluating λ=0.25, lr=1e-03, pl=1...
    Hard=0.7807, Soft=0.7670
  [35/82] Evaluating λ=0.25, lr=1e-03, pl=5...
    Hard=0.7914, Soft=0.7991
  [36/82] Evaluating λ=0.25, lr=1e-03, pl=10...
    Hard=0.7988, Soft=0.8049
  [37/82] Evaluating λ=0.25, lr=1e-03, pl=20...
    Hard=0.8018, Soft=0.7951
  [38/82] Evaluating λ=0.25, lr=1e-03, pl=50...
    Hard=0.7991, Soft=0.8125
  [39/82] Evaluating λ=0.25, lr=1e-03, pl=100...
    Hard=0.8000, Soft=0.8028
  [40/82] Evaluating λ=0.25, lr=1e-02, pl=1...
    Hard=0.7853, Soft=0.7547
  [41/82] Evaluating λ=0.25, lr=1e-02, pl=5...
    Hard=0.7933, Soft=0.8024
  [42/82] Evaluating λ=0.25, lr=1e-02, pl=10...
    Hard=0.7997, Soft=0.7988
  [43/82] Evaluating λ=0.25, lr=1e-02, pl=20...
    Hard=0.7979, Soft=0.8107
  [44/82] Evaluating λ=0.25, lr=1e-02, pl=50...
    Hard=0.8000, Soft=0.7954
  [45/82] Evaluating λ=0.5, lr=1e-03, pl=1...
    Hard=0.7832, Soft=0.7875
  [46/82] Evaluating λ=0.5, lr=1e-03, pl=5...
    Hard=0.7933, Soft=0.7881
  [47/82] Evaluating λ=0.5, lr=1e-03, pl=10...
    Hard=0.7960, Soft=0.8003
  [48/82] Evaluating λ=0.5, lr=1e-03, pl=20...
    Hard=0.8024, Soft=0.7917
  [49/82] Evaluating λ=0.5, lr=1e-03, pl=50...
    Hard=0.8024, Soft=0.7994
  [50/82] Evaluating λ=0.5, lr=1e-03, pl=100...
    Hard=0.8049, Soft=0.8070
  [51/82] Evaluating λ=0.5, lr=1e-02, pl=1...
    Hard=0.7924, Soft=0.6948
  [52/82] Evaluating λ=0.5, lr=1e-02, pl=5...
    Hard=0.7957, Soft=0.6651
  [53/82] Evaluating λ=0.5, lr=1e-02, pl=10...
    Hard=0.7985, Soft=0.8110
  [54/82] Evaluating λ=0.5, lr=1e-02, pl=50...
    Hard=0.7914, Soft=0.8076
  [55/82] Evaluating λ=0.5, lr=1e-02, pl=100...
    Hard=0.7997, Soft=0.8092
  [56/82] Evaluating λ=0.75, lr=1e-03, pl=1...
    Hard=0.7881, Soft=0.7749
  [57/82] Evaluating λ=0.75, lr=1e-03, pl=5...
    Hard=0.7884, Soft=0.8034
  [58/82] Evaluating λ=0.75, lr=1e-03, pl=10...
    Hard=0.7917, Soft=0.8089
  [59/82] Evaluating λ=0.75, lr=1e-03, pl=20...
    Hard=0.7963, Soft=0.8028
  [60/82] Evaluating λ=0.75, lr=1e-03, pl=100...
    Hard=0.8018, Soft=0.8058
  [61/82] Evaluating λ=0.75, lr=1e-02, pl=1...
    Hard=0.7706, Soft=0.6713
  [62/82] Evaluating λ=0.75, lr=1e-02, pl=5...
    Hard=0.7893, Soft=0.7722
  [63/82] Evaluating λ=0.75, lr=1e-02, pl=10...
    Hard=0.8018, Soft=0.7709
  [64/82] Evaluating λ=0.75, lr=1e-02, pl=20...
    Hard=0.8006, Soft=0.8104
  [65/82] Evaluating λ=0.75, lr=1e-02, pl=50...
    Hard=0.7991, Soft=0.7896
  [66/82] Evaluating λ=0.75, lr=1e-02, pl=100...
    Hard=0.7948, Soft=0.8107
  [67/82] Evaluating λ=1.0, lr=1e-03, pl=1...
    Hard=0.7572, Soft=0.7679
  [68/82] Evaluating λ=1.0, lr=1e-03, pl=5...
    Hard=0.7942, Soft=0.7817
  [69/82] Evaluating λ=1.0, lr=1e-03, pl=10...
    Hard=0.7948, Soft=0.8086
  [70/82] Evaluating λ=1.0, lr=1e-03, pl=20...
    Hard=0.8028, Soft=0.8058
  [71/82] Evaluating λ=1.0, lr=1e-03, pl=50...
    Hard=0.7651, Soft=0.7960
  [72/82] Evaluating λ=1.0, lr=1e-02, pl=1...
    Hard=0.7810, Soft=0.7679
  [73/82] Evaluating λ=1.0, lr=1e-02, pl=5...
    Hard=0.7969, Soft=0.6960
  [74/82] Evaluating λ=1.0, lr=1e-02, pl=10...
    Hard=0.7972, Soft=0.7936
  [75/82] Evaluating λ=1.0, lr=1e-02, pl=20...
    Hard=0.8009, Soft=0.7911
  [76/82] Evaluating λ=1.0, lr=1e-02, pl=50...
    Hard=0.8006, Soft=0.8055
  [77/82] Evaluating λ=1.0, lr=1e-02, pl=100...
    Hard=0.8028, Soft=0.7817
  [78/82] Evaluating λ=10.0, lr=1e-01, pl=1...
    Hard=0.7820, Soft=0.7422
  [79/82] Evaluating λ=10.0, lr=1e-01, pl=5...
    Hard=0.7972, Soft=0.7988
  [80/82] Evaluating λ=10.0, lr=1e-01, pl=10...
    Hard=0.7985, Soft=0.6217
  [81/82] Evaluating λ=10.0, lr=1e-01, pl=20...
    Hard=0.7920, Soft=0.6180
  [82/82] Evaluating λ=10.0, lr=1e-01, pl=50...
    Hard=0.8000, Soft=0.6217
"""

adv_output = """
Evaluating 119 adversarial models...

  [1/119] Evaluating λ=0.0, lr=1e-06, pl=1...
    Hard=0.7865, Soft=0.6214
  [2/119] Evaluating λ=0.0, lr=1e-06, pl=5...
    Hard=0.7954, Soft=0.4364
  [3/119] Evaluating λ=0.0, lr=1e-06, pl=10...
    Hard=0.7985, Soft=0.3865
  [4/119] Evaluating λ=0.0, lr=1e-06, pl=20...
    Hard=0.8006, Soft=0.6746
  [5/119] Evaluating λ=0.0, lr=1e-06, pl=50...
    Hard=0.7994, Soft=0.6706
  [6/119] Evaluating λ=0.0, lr=1e-06, pl=100...
    Hard=0.8043, Soft=0.3844
  [7/119] Evaluating λ=0.0, lr=1e-03, pl=1...
    Hard=0.7890, Soft=0.6587
  [8/119] Evaluating λ=0.0, lr=1e-03, pl=5...
    Hard=0.7985, Soft=0.6223
  [9/119] Evaluating λ=0.0, lr=1e-03, pl=10...
    Hard=0.8015, Soft=0.5954
  [10/119] Evaluating λ=0.0, lr=1e-03, pl=20...
    Hard=0.7969, Soft=0.6064
  [11/119] Evaluating λ=0.0, lr=1e-03, pl=50...
    Hard=0.8031, Soft=0.6217
  [12/119] Evaluating λ=0.0, lr=1e-03, pl=100...
    Hard=0.7988, Soft=0.6217
  [13/119] Evaluating λ=0.0, lr=1e-01, pl=5...
    Hard=0.7810, Soft=0.6217
  [14/119] Evaluating λ=0.0, lr=1e-01, pl=10...
    Hard=0.8006, Soft=0.6217
  [15/119] Evaluating λ=0.0, lr=1e-01, pl=20...
    Hard=0.7994, Soft=0.3783
  [16/119] Evaluating λ=0.0, lr=1e-01, pl=50...
    Hard=0.8049, Soft=0.6217
  [17/119] Evaluating λ=0.0, lr=1e-01, pl=100...
    Hard=0.7991, Soft=0.3783
  [18/119] Evaluating λ=0.01, lr=1e-06, pl=1...
    Hard=0.7884, Soft=0.6021
  [19/119] Evaluating λ=0.01, lr=1e-06, pl=5...
    Hard=0.7942, Soft=0.3936
  [20/119] Evaluating λ=0.01, lr=1e-06, pl=10...
    Hard=0.7982, Soft=0.3801
  [21/119] Evaluating λ=0.01, lr=1e-06, pl=20...
    Hard=0.8009, Soft=0.3783
  [22/119] Evaluating λ=0.01, lr=1e-06, pl=50...
    Hard=0.7997, Soft=0.5865
  [23/119] Evaluating λ=0.01, lr=1e-06, pl=100...
    Hard=0.7960, Soft=0.5394
  [24/119] Evaluating λ=0.01, lr=1e-03, pl=1...
    Hard=0.7896, Soft=0.6076
  [25/119] Evaluating λ=0.01, lr=1e-03, pl=5...
    Hard=0.7939, Soft=0.6459
  [26/119] Evaluating λ=0.01, lr=1e-03, pl=10...
    Hard=0.7945, Soft=0.6211
  [27/119] Evaluating λ=0.01, lr=1e-03, pl=20...
    Hard=0.8040, Soft=0.6217
  [28/119] Evaluating λ=0.01, lr=1e-03, pl=50...
    Hard=0.8046, Soft=0.6217
  [29/119] Evaluating λ=0.01, lr=1e-03, pl=100...
    Hard=0.8006, Soft=0.6217
  [30/119] Evaluating λ=0.1, lr=1e-06, pl=5...
    Hard=0.7896, Soft=0.3887
  [31/119] Evaluating λ=0.1, lr=1e-06, pl=10...
    Hard=0.7972, Soft=0.3875
  [32/119] Evaluating λ=0.1, lr=1e-06, pl=20...
    Hard=0.7979, Soft=0.3783
  [33/119] Evaluating λ=0.1, lr=1e-06, pl=50...
    Hard=0.8040, Soft=0.6810
  [34/119] Evaluating λ=0.1, lr=1e-06, pl=100...
    Hard=0.8015, Soft=0.7278
  [35/119] Evaluating λ=0.1, lr=1e-03, pl=1...
    Hard=0.7801, Soft=0.6850
  [36/119] Evaluating λ=0.1, lr=1e-03, pl=5...
    Hard=0.7924, Soft=0.6254
  [37/119] Evaluating λ=0.1, lr=1e-03, pl=10...
    Hard=0.7844, Soft=0.6128
  [38/119] Evaluating λ=0.1, lr=1e-03, pl=20...
    Hard=0.7982, Soft=0.6217
  [39/119] Evaluating λ=0.1, lr=1e-03, pl=50...
    Hard=0.8021, Soft=0.3783
  [40/119] Evaluating λ=0.1, lr=1e-03, pl=100...
    Hard=0.7972, Soft=0.6202
  [41/119] Evaluating λ=0.1, lr=1e-01, pl=1...
    Hard=0.7936, Soft=0.4043
  [42/119] Evaluating λ=0.1, lr=1e-01, pl=5...
    Hard=0.7899, Soft=0.6355
  [43/119] Evaluating λ=0.1, lr=1e-01, pl=10...
    Hard=0.7829, Soft=0.6327
  [44/119] Evaluating λ=0.1, lr=1e-01, pl=20...
    Hard=0.8034, Soft=0.4006
  [45/119] Evaluating λ=0.1, lr=1e-01, pl=50...
    Hard=0.7939, Soft=0.6217
  [46/119] Evaluating λ=0.1, lr=1e-01, pl=100...
    Hard=0.8018, Soft=0.6217
  [47/119] Evaluating λ=0.25, lr=1e-06, pl=1...
    Hard=0.7905, Soft=0.5817
  [48/119] Evaluating λ=0.25, lr=1e-06, pl=5...
    Hard=0.7954, Soft=0.4933
  [49/119] Evaluating λ=0.25, lr=1e-06, pl=10...
    Hard=0.8003, Soft=0.3795
  [50/119] Evaluating λ=0.25, lr=1e-06, pl=20...
    Hard=0.8000, Soft=0.7459
  [51/119] Evaluating λ=0.25, lr=1e-06, pl=50...
    Hard=0.8024, Soft=0.3795
  [52/119] Evaluating λ=0.25, lr=1e-06, pl=100...
    Hard=0.7994, Soft=0.6599
  [53/119] Evaluating λ=0.25, lr=1e-03, pl=1...
    Hard=0.7841, Soft=0.6385
  [54/119] Evaluating λ=0.25, lr=1e-03, pl=5...
    Hard=0.7954, Soft=0.6370
  [55/119] Evaluating λ=0.25, lr=1e-03, pl=10...
    Hard=0.7985, Soft=0.4052
  [56/119] Evaluating λ=0.25, lr=1e-03, pl=20...
    Hard=0.8034, Soft=0.6217
  [57/119] Evaluating λ=0.25, lr=1e-03, pl=50...
    Hard=0.8055, Soft=0.3783
  [58/119] Evaluating λ=0.25, lr=1e-03, pl=100...
    Hard=0.8037, Soft=0.5043
  [59/119] Evaluating λ=0.25, lr=1e-01, pl=5...
    Hard=0.7930, Soft=0.6284
  [60/119] Evaluating λ=0.25, lr=1e-01, pl=10...
    Hard=0.7972, Soft=0.6217
  [61/119] Evaluating λ=0.25, lr=1e-01, pl=20...
    Hard=0.7994, Soft=0.6217
  [62/119] Evaluating λ=0.25, lr=1e-01, pl=50...
    Hard=0.8034, Soft=0.6217
  [63/119] Evaluating λ=0.25, lr=1e-01, pl=100...
    Hard=0.7957, Soft=0.6217
  [64/119] Evaluating λ=0.5, lr=1e-06, pl=1...
    Hard=0.7908, Soft=0.5991
  [65/119] Evaluating λ=0.5, lr=1e-06, pl=5...
    Hard=0.7878, Soft=0.3789
  [66/119] Evaluating λ=0.5, lr=1e-06, pl=10...
    Hard=0.7881, Soft=0.4015
  [67/119] Evaluating λ=0.5, lr=1e-06, pl=20...
    Hard=0.7997, Soft=0.6728
  [68/119] Evaluating λ=0.5, lr=1e-06, pl=50...
    Hard=0.8031, Soft=0.4346
  [69/119] Evaluating λ=0.5, lr=1e-06, pl=100...
    Hard=0.7924, Soft=0.3817
  [70/119] Evaluating λ=0.5, lr=1e-03, pl=5...
    Hard=0.7966, Soft=0.6217
  [71/119] Evaluating λ=0.5, lr=1e-03, pl=10...
    Hard=0.7994, Soft=0.4242
  [72/119] Evaluating λ=0.5, lr=1e-03, pl=20...
    Hard=0.7991, Soft=0.6217
  [73/119] Evaluating λ=0.5, lr=1e-03, pl=50...
    Hard=0.8037, Soft=0.6220
  [74/119] Evaluating λ=0.5, lr=1e-03, pl=100...
    Hard=0.8021, Soft=0.5884
  [75/119] Evaluating λ=0.5, lr=1e-01, pl=1...
    Hard=0.7820, Soft=0.6239
  [76/119] Evaluating λ=0.5, lr=1e-01, pl=5...
    Hard=0.7887, Soft=0.6217
  [77/119] Evaluating λ=0.5, lr=1e-01, pl=10...
    Hard=0.7948, Soft=0.6217
  [78/119] Evaluating λ=0.5, lr=1e-01, pl=20...
    Hard=0.7972, Soft=0.6214
  [79/119] Evaluating λ=0.5, lr=1e-01, pl=50...
    Hard=0.8015, Soft=0.5694
  [80/119] Evaluating λ=0.5, lr=1e-01, pl=100...
    Hard=0.8049, Soft=0.6217
  [81/119] Evaluating λ=0.75, lr=1e-06, pl=5...
    Hard=0.7917, Soft=0.3872
  [82/119] Evaluating λ=0.75, lr=1e-06, pl=10...
    Hard=0.7920, Soft=0.4046
  [83/119] Evaluating λ=0.75, lr=1e-06, pl=20...
    Hard=0.8012, Soft=0.5575
  [84/119] Evaluating λ=0.75, lr=1e-06, pl=50...
    Hard=0.7988, Soft=0.3792
  [85/119] Evaluating λ=0.75, lr=1e-06, pl=100...
    Hard=0.8009, Soft=0.5569
  [86/119] Evaluating λ=0.75, lr=1e-03, pl=1...
    Hard=0.7829, Soft=0.6315
  [87/119] Evaluating λ=0.75, lr=1e-03, pl=5...
    Hard=0.7862, Soft=0.4700
  [88/119] Evaluating λ=0.75, lr=1e-03, pl=10...
    Hard=0.7985, Soft=0.6257
  [89/119] Evaluating λ=0.75, lr=1e-03, pl=20...
    Hard=0.8018, Soft=0.6226
  [90/119] Evaluating λ=0.75, lr=1e-03, pl=50...
    Hard=0.7924, Soft=0.6217
  [91/119] Evaluating λ=0.75, lr=1e-03, pl=100...
    Hard=0.8040, Soft=0.6217
  [92/119] Evaluating λ=0.75, lr=1e-01, pl=1...
    Hard=0.7847, Soft=0.6171
  [93/119] Evaluating λ=0.75, lr=1e-01, pl=5...
    Hard=0.7936, Soft=0.6202
  [94/119] Evaluating λ=0.75, lr=1e-01, pl=10...
    Hard=0.7976, Soft=0.6217
  [95/119] Evaluating λ=0.75, lr=1e-01, pl=20...
    Hard=0.7994, Soft=0.6223
  [96/119] Evaluating λ=0.75, lr=1e-01, pl=50...
    Hard=0.8015, Soft=0.6217
  [97/119] Evaluating λ=0.75, lr=1e-01, pl=100...
    Hard=0.8061, Soft=0.6217
  [98/119] Evaluating λ=1.0, lr=1e-06, pl=1...
    Hard=0.7908, Soft=0.4945
  [99/119] Evaluating λ=1.0, lr=1e-06, pl=5...
    Hard=0.7911, Soft=0.3881
  [100/119] Evaluating λ=1.0, lr=1e-06, pl=10...
    Hard=0.8028, Soft=0.3875
  [101/119] Evaluating λ=1.0, lr=1e-06, pl=20...
    Hard=0.8031, Soft=0.7541
  [102/119] Evaluating λ=1.0, lr=1e-06, pl=50...
    Hard=0.7979, Soft=0.5312
  [103/119] Evaluating λ=1.0, lr=1e-06, pl=100...
    Hard=0.7997, Soft=0.4875
  [104/119] Evaluating λ=1.0, lr=1e-03, pl=1...
    Hard=0.7902, Soft=0.6401
  [105/119] Evaluating λ=1.0, lr=1e-03, pl=5...
    Hard=0.7936, Soft=0.6336
  [106/119] Evaluating λ=1.0, lr=1e-03, pl=10...
    Hard=0.8000, Soft=0.6089
  [107/119] Evaluating λ=1.0, lr=1e-03, pl=20...
    Hard=0.7979, Soft=0.6217
  [108/119] Evaluating λ=1.0, lr=1e-03, pl=50...
    Hard=0.8031, Soft=0.6229
  [109/119] Evaluating λ=1.0, lr=1e-03, pl=100...
    Hard=0.7966, Soft=0.3783
  [110/119] Evaluating λ=1.0, lr=1e-01, pl=5...
    Hard=0.7875, Soft=0.5541
  [111/119] Evaluating λ=1.0, lr=1e-01, pl=10...
    Hard=0.7869, Soft=0.6217
  [112/119] Evaluating λ=1.0, lr=1e-01, pl=20...
    Hard=0.8012, Soft=0.6214
  [113/119] Evaluating λ=1.0, lr=1e-01, pl=50...
    Hard=0.7988, Soft=0.6199
  [114/119] Evaluating λ=1.0, lr=1e-01, pl=100...
    Hard=0.8052, Soft=0.6217
  [115/119] Evaluating λ=10.0, lr=1e-01, pl=5...
    Hard=0.7844, Soft=0.6156
  [116/119] Evaluating λ=10.0, lr=1e-01, pl=10...
    Hard=0.7957, Soft=0.6235
  [117/119] Evaluating λ=10.0, lr=1e-01, pl=20...
    Hard=0.7850, Soft=0.6113
  [118/119] Evaluating λ=10.0, lr=1e-01, pl=50...
    Hard=0.7994, Soft=0.6217
  [119/119] Evaluating λ=10.0, lr=1e-01, pl=100...
    Hard=0.8003, Soft=0.6217
"""

def parse_output(text, is_adversarial=False):
    """Parse terminal output and extract data."""
    data = []
    pattern = r'λ=([0-9.]+), lr=([0-9.e-]+), pl=([0-9]+)'
    hard_pattern = r'Hard=([0-9.]+)'
    soft_pattern = r'Soft=([0-9.]+)'
    
    lines = text.split('\n')
    for i, line in enumerate(lines):
        match = re.search(pattern, line)
        if match:
            lam = float(match.group(1))
            lr = float(match.group(2))
            pl = int(match.group(3))
            
            # Get hard and soft from next line
            if i + 1 < len(lines):
                hard_match = re.search(hard_pattern, lines[i + 1])
                soft_match = re.search(soft_pattern, lines[i + 1])
                if hard_match and soft_match:
                    hard_acc = float(hard_match.group(1))
                    soft_acc = float(soft_match.group(1))
                    data.append({
                        'lambda': lam,
                        'lr': lr,
                        'prompt_length': pl,
                        'hard_prompt_acc': hard_acc,
                        'soft_prompt_acc': soft_acc,
                        'difference': hard_acc - soft_acc,
                        'adversarial': is_adversarial
                    })
    return data

def select_best_worst(data, is_adversarial=False):
    """Select best (non-adv) or worst (adv) for each (lambda, prompt_length) pair."""
    grouped = defaultdict(list)
    for item in data:
        key = (item['lambda'], item['prompt_length'])
        grouped[key].append(item)
    
    results = []
    for (lam, pl), items in sorted(grouped.items()):
        if is_adversarial:
            selected = min(items, key=lambda x: x['hard_prompt_acc'])
        else:
            selected = max(items, key=lambda x: x['hard_prompt_acc'])
        results.append(selected)
    
    return results

def print_table(results, title):
    """Print formatted table."""
    print("\n" + "=" * 100)
    print(title)
    print("=" * 100)
    print(f"{'Lambda':<10} {'Prompt Length':<15} {'LR':<12} {'Hard Acc':<12} {'Soft Acc':<12} {'Difference':<12}")
    print("-" * 100)
    
    for r in sorted(results, key=lambda x: (x['lambda'], x['prompt_length'])):
        print(f"{r['lambda']:<10.2f} {r['prompt_length']:<15} "
              f"{r['lr']:<12.2e} {r['hard_prompt_acc']:<12.4f} "
              f"{r['soft_prompt_acc']:<12.4f} {r['difference']:<12.4f}")

def create_pivot_table(results):
    """Create pivot table."""
    from collections import defaultdict
    pivot = defaultdict(dict)
    
    for r in results:
        lam = r['lambda']
        pl = r['prompt_length']
        pivot[lam][pl] = r['hard_prompt_acc']
    
    # Get all prompt lengths
    all_pls = sorted(set(pl for r in results for pl in [r['prompt_length']]))
    all_lams = sorted(set(r['lambda'] for r in results))
    
    print(f"\n{'Lambda':<10}", end="")
    for pl in all_pls:
        print(f"{pl:<12}", end="")
    print()
    print("-" * (10 + 12 * len(all_pls)))
    
    for lam in all_lams:
        print(f"{lam:<10.2f}", end="")
        for pl in all_pls:
            if pl in pivot[lam]:
                print(f"{pivot[lam][pl]:<12.4f}", end="")
            else:
                print(f"{'N/A':<12}", end="")
        print()

if __name__ == "__main__":
    # Parse data
    non_adv_data = parse_output(non_adv_output, is_adversarial=False)
    adv_data = parse_output(adv_output, is_adversarial=True)
    
    # Select best/worst
    non_adv_selected = select_best_worst(non_adv_data, is_adversarial=False)
    adv_selected = select_best_worst(adv_data, is_adversarial=True)
    
    # Print tables
    print_table(non_adv_selected, "NON-ADVERSARIAL: Best Hard Prompt Accuracy per (Lambda, Prompt Length)")
    print_table(adv_selected, "ADVERSARIAL: Worst Hard Prompt Accuracy per (Lambda, Prompt Length)")
    
    # Print pivot tables
    print("\n" + "=" * 100)
    print("NON-ADVERSARIAL: Hard Prompt Accuracy Pivot Table")
    print("=" * 100)
    create_pivot_table(non_adv_selected)
    
    print("\n" + "=" * 100)
    print("ADVERSARIAL: Hard Prompt Accuracy Pivot Table")
    print("=" * 100)
    create_pivot_table(adv_selected)

