================================================================================
Continuous Soft Prompt Training
================================================================================
Model: t5-large
Prompt Length: 5
Learning Rate: 0.001
Epochs: 10
Batch Size: 16
Adversarial: True
Device: cuda
Output Dir: /mnt/polished-lake/home/annabelma/other/results_fixed/continuous/continuous_soft_prompt_len_10epochs
================================================================================

Loading tokenizer and data...
Balanced BoolQ train: 7106 examples (3553 True, 3553 False)

Training continuous soft prompt (ADVERSARIAL)...
[Continuous ADV] Epoch 1/10 | joint=15.8371 task=15.8371 val_loss=13.0165 val_acc=0.5434 (true=0.2927 false=0.9555) ‖prompt‖=1.44
[Continuous ADV] Epoch 2/10 | joint=13.1067 task=13.1067 val_loss=12.1754 val_acc=0.4676 (true=0.1579 false=0.9766) ‖prompt‖=1.44
[Continuous ADV] Epoch 3/10 | joint=12.3190 task=12.3190 val_loss=11.7310 val_acc=0.4220 (true=0.0787 false=0.9863) ‖prompt‖=1.45
[Continuous ADV] Epoch 4/10 | joint=11.8534 task=11.8534 val_loss=10.2065 val_acc=0.4177 (true=0.0689 false=0.9911) ‖prompt‖=1.45
[Continuous ADV] Epoch 5/10 | joint=10.4570 task=10.4570 val_loss=8.8057 val_acc=0.3988 (true=0.0359 false=0.9951) ‖prompt‖=1.46
[Continuous ADV] Epoch 6/10 | joint=9.5108 task=9.5108 val_loss=7.6359 val_acc=0.4089 (true=0.0566 false=0.9879) ‖prompt‖=1.48
[Continuous ADV] Epoch 7/10 | joint=8.9197 task=8.9197 val_loss=6.1103 val_acc=0.4474 (true=0.1289 false=0.9709) ‖prompt‖=1.48
[Continuous ADV] Epoch 8/10 | joint=8.2961 task=8.2961 val_loss=5.0462 val_acc=0.4917 (true=0.2145 false=0.9475) ‖prompt‖=1.49
[Continuous ADV] Epoch 9/10 | joint=7.6921 task=7.6921 val_loss=3.5434 val_acc=0.5679 (true=0.3714 false=0.8909) ‖prompt‖=1.50
[Continuous ADV] Epoch 10/10 | joint=7.1620 task=7.1620 val_loss=2.2599 val_acc=0.5508 (true=0.3517 false=0.8779) ‖prompt‖=1.51

Saved model to: /mnt/polished-lake/home/annabelma/other/results_fixed/continuous/continuous_soft_prompt_len_10epochs/model_adversarial_True_lr_0.001_promptlen_5.pt
Saved history to: /mnt/polished-lake/home/annabelma/other/results_fixed/continuous/continuous_soft_prompt_len_10epochs/history_adversarial_True_lr_0.001_promptlen_5.json

================================================================================
Training Summary
================================================================================
Best Validation Accuracy: 0.5679
Final Validation Accuracy: 0.5508
Best True Accuracy: 0.3714
Best False Accuracy: 0.9951
================================================================================
Job 8 completed: lr=1e-3, prompt_length=5, epochs=10, adversarial=--adversarial
