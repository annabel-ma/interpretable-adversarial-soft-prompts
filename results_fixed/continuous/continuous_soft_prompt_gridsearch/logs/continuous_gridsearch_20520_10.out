================================================================================
Continuous Soft Prompt Training
================================================================================
Model: t5-large
Prompt Length: 10
Learning Rate: 0.01
Epochs: 10
Batch Size: 16
Adversarial: True
Device: cuda
Output Dir: /mnt/polished-lake/home/annabelma/other/results_fixed/continuous/continuous_soft_prompt_gridsearch
================================================================================

Loading tokenizer and data...
Balanced BoolQ train: 7106 examples (3553 True, 3553 False)

Training continuous soft prompt (ADVERSARIAL)...
[Continuous ADV] Epoch 1/10 | joint=10.4225 task=10.4225 val_loss=3.4406 val_acc=0.6878 (true=0.7245 false=0.6273) ‖prompt‖=3.05
[Continuous ADV] Epoch 2/10 | joint=4.8312 task=4.8312 val_loss=0.5421 val_acc=0.6908 (true=0.7368 false=0.6152) ‖prompt‖=3.68
[Continuous ADV] Epoch 3/10 | joint=3.0958 task=3.0958 val_loss=0.2614 val_acc=0.6498 (true=0.6409 false=0.6645) ‖prompt‖=4.23
[Continuous ADV] Epoch 4/10 | joint=2.1909 task=2.1909 val_loss=0.2173 val_acc=0.7031 (true=0.8780 false=0.4155) ‖prompt‖=4.69
[Continuous ADV] Epoch 5/10 | joint=1.8103 task=1.8103 val_loss=0.1570 val_acc=0.6884 (true=0.8815 false=0.3711) ‖prompt‖=5.11
[Continuous ADV] Epoch 6/10 | joint=1.5619 task=1.5619 val_loss=0.1622 val_acc=0.6829 (true=0.9538 false=0.2377) ‖prompt‖=5.50
[Continuous ADV] Epoch 7/10 | joint=1.4815 task=1.4815 val_loss=0.1711 val_acc=0.6664 (true=0.9739 false=0.1609) ‖prompt‖=5.86
[Continuous ADV] Epoch 8/10 | joint=1.3602 task=1.3602 val_loss=0.1568 val_acc=0.6768 (true=0.9611 false=0.2094) ‖prompt‖=6.20
[Continuous ADV] Epoch 9/10 | joint=1.3405 task=1.3405 val_loss=0.1563 val_acc=0.6725 (true=0.7319 false=0.5748) ‖prompt‖=6.51
[Continuous ADV] Epoch 10/10 | joint=1.3740 task=1.3740 val_loss=0.1619 val_acc=0.6486 (true=0.9144 false=0.2118) ‖prompt‖=6.83

Saved model to: /mnt/polished-lake/home/annabelma/other/results_fixed/continuous/continuous_soft_prompt_gridsearch/model_adversarial_True_lr_0.01_promptlen_10.pt
Saved history to: /mnt/polished-lake/home/annabelma/other/results_fixed/continuous/continuous_soft_prompt_gridsearch/history_adversarial_True_lr_0.01_promptlen_10.json

================================================================================
Training Summary
================================================================================
Best Validation Accuracy: 0.7031
Final Validation Accuracy: 0.6486
Best True Accuracy: 0.9739
Best False Accuracy: 0.6645
================================================================================
Job 10 completed: lr=1e-2, prompt_length=10, epochs=10, adversarial=--adversarial
