================================================================================
Continuous Soft Prompt Training
================================================================================
Model: t5-large
Prompt Length: 10
Learning Rate: 0.001
Epochs: 10
Batch Size: 16
Adversarial: True
Device: cuda
Output Dir: /mnt/polished-lake/home/annabelma/other/results_fixed/continuous/continuous_soft_prompt_gridsearch
================================================================================

Loading tokenizer and data...
Balanced BoolQ train: 7106 examples (3553 True, 3553 False)

Training continuous soft prompt (ADVERSARIAL)...
[Continuous ADV] Epoch 1/10 | joint=15.5118 task=15.5118 val_loss=16.5007 val_acc=0.7171 (true=0.6173 false=0.8812) ‖prompt‖=2.04
[Continuous ADV] Epoch 2/10 | joint=13.1966 task=13.1966 val_loss=12.0530 val_acc=0.4920 (true=0.2061 false=0.9620) ‖prompt‖=2.04
[Continuous ADV] Epoch 3/10 | joint=11.0230 task=11.0230 val_loss=8.8991 val_acc=0.3960 (true=0.0325 false=0.9935) ‖prompt‖=2.05
[Continuous ADV] Epoch 4/10 | joint=9.0719 task=9.0719 val_loss=6.3707 val_acc=0.5211 (true=0.2691 false=0.9353) ‖prompt‖=2.06
[Continuous ADV] Epoch 5/10 | joint=7.3013 task=7.3013 val_loss=3.2240 val_acc=0.5398 (true=0.3281 false=0.8876) ‖prompt‖=2.07
[Continuous ADV] Epoch 6/10 | joint=5.4547 task=5.4547 val_loss=1.1470 val_acc=0.5664 (true=0.3851 false=0.8642) ‖prompt‖=2.08
[Continuous ADV] Epoch 7/10 | joint=4.2724 task=4.2724 val_loss=0.8658 val_acc=0.6847 (true=0.6586 false=0.7276) ‖prompt‖=2.09
[Continuous ADV] Epoch 8/10 | joint=3.6463 task=3.6463 val_loss=0.7502 val_acc=0.7226 (true=0.8032 false=0.5901) ‖prompt‖=2.10
[Continuous ADV] Epoch 9/10 | joint=3.1998 task=3.1998 val_loss=0.6798 val_acc=0.7141 (true=0.8283 false=0.5263) ‖prompt‖=2.11
[Continuous ADV] Epoch 10/10 | joint=2.9765 task=2.9765 val_loss=0.5385 val_acc=0.7162 (true=0.8731 false=0.4584) ‖prompt‖=2.12

Saved model to: /mnt/polished-lake/home/annabelma/other/results_fixed/continuous/continuous_soft_prompt_gridsearch/model_adversarial_True_lr_0.001_promptlen_10.pt
Saved history to: /mnt/polished-lake/home/annabelma/other/results_fixed/continuous/continuous_soft_prompt_gridsearch/history_adversarial_True_lr_0.001_promptlen_10.json

================================================================================
Training Summary
================================================================================
Best Validation Accuracy: 0.7226
Final Validation Accuracy: 0.7162
Best True Accuracy: 0.8731
Best False Accuracy: 0.9935
================================================================================
Job 8 completed: lr=1e-3, prompt_length=10, epochs=10, adversarial=--adversarial
