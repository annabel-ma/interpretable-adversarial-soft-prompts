================================================================================
Continuous Soft Prompt Training
================================================================================
Model: t5-large
Prompt Length: 10
Learning Rate: 1e-05
Epochs: 10
Batch Size: 16
Adversarial: True
Device: cuda
Output Dir: /mnt/polished-lake/home/annabelma/other/results_fixed/continuous/continuous_soft_prompt_gridsearch
================================================================================

Loading tokenizer and data...
Balanced BoolQ train: 7106 examples (3553 True, 3553 False)

Training continuous soft prompt (ADVERSARIAL)...
[Continuous ADV] Epoch 1/10 | joint=17.3104 task=17.3104 val_loss=20.2707 val_acc=0.7636 (true=0.6975 false=0.8723) ‖prompt‖=2.03
[Continuous ADV] Epoch 2/10 | joint=17.2871 task=17.2871 val_loss=20.2259 val_acc=0.7624 (true=0.6980 false=0.8682) ‖prompt‖=2.03
[Continuous ADV] Epoch 3/10 | joint=17.2328 task=17.2328 val_loss=20.1792 val_acc=0.7609 (true=0.6970 false=0.8658) ‖prompt‖=2.03
[Continuous ADV] Epoch 4/10 | joint=17.1931 task=17.1931 val_loss=20.1234 val_acc=0.7642 (true=0.7004 false=0.8690) ‖prompt‖=2.03
[Continuous ADV] Epoch 5/10 | joint=17.1267 task=17.1267 val_loss=20.0668 val_acc=0.7639 (true=0.7004 false=0.8682) ‖prompt‖=2.03
[Continuous ADV] Epoch 6/10 | joint=17.0147 task=17.0147 val_loss=19.9978 val_acc=0.7657 (true=0.7019 false=0.8707) ‖prompt‖=2.03
[Continuous ADV] Epoch 7/10 | joint=16.9961 task=16.9961 val_loss=19.9345 val_acc=0.7645 (true=0.7004 false=0.8698) ‖prompt‖=2.03
[Continuous ADV] Epoch 8/10 | joint=16.9101 task=16.9101 val_loss=19.8662 val_acc=0.7615 (true=0.6970 false=0.8674) ‖prompt‖=2.03
[Continuous ADV] Epoch 9/10 | joint=16.9114 task=16.9114 val_loss=19.7932 val_acc=0.7599 (true=0.6945 false=0.8674) ‖prompt‖=2.03
[Continuous ADV] Epoch 10/10 | joint=16.7907 task=16.7907 val_loss=19.7261 val_acc=0.7612 (true=0.6975 false=0.8658) ‖prompt‖=2.03

Saved model to: /mnt/polished-lake/home/annabelma/other/results_fixed/continuous/continuous_soft_prompt_gridsearch/model_adversarial_True_lr_1e-05_promptlen_10.pt
Saved history to: /mnt/polished-lake/home/annabelma/other/results_fixed/continuous/continuous_soft_prompt_gridsearch/history_adversarial_True_lr_1e-05_promptlen_10.json

================================================================================
Training Summary
================================================================================
Best Validation Accuracy: 0.7657
Final Validation Accuracy: 0.7612
Best True Accuracy: 0.7019
Best False Accuracy: 0.8723
================================================================================
Job 4 completed: lr=1e-5, prompt_length=10, epochs=10, adversarial=--adversarial
